# Система мониторинга веб-страниц

Система мониторинга веб-страниц - это инструмент для удаленного отслеживания действий пользователей на веб-сайтах в реальном времени через WebSocket. Позволяет администраторам наблюдать за содержимым страниц, отправлять сообщения и взаимодействовать с клиентскими браузерами.

## Технологии и архитектура

- **Бэкенд**: Node.js, Express, WebSocket (ws)
- **Фронтенд**: Чистый JavaScript, HTML, CSS
- **Аутентификация**: Хеширование паролей с SHA-256 и солью
- **Развертывание**: Размещен на Render.com с доменом zxc11.space

## Основные функции

### Администраторская панель
- Аутентификация администраторов
- Мониторинг активности клиентов в реальном времени
- Отправка сообщений клиентам
- Управление кодами доступа
- История сессий и отключений
- Управление пользователями и правами

### Клиентская часть
- Автоматическая установка через коды доступа
- Несколько способов внедрения клиента:
  - Уникальные 3-символьные коды доступа
  - Букмарклет
  - Service Worker для автозагрузки после перезагрузки страницы
- Сбор и передача данных о странице (текст, URL, заголовок)
- Отображение сообщений от администратора
- Горячие клавиши для управления

## Архитектура проекта

### Структура файлов
```
├── server.js              # Основной серверный файл
├── package.json           # Зависимости и скрипты
├── public/                # Статические файлы
│   ├── admin.html         # Страница администратора
│   ├── login.html         # Страница входа
│   ├── client.js          # Клиентский скрипт для мониторинга
│   ├── loader.js          # Загрузчик клиентского скрипта
│   ├── webmonitoring-sw.js # Service Worker
│   ├── access-codes.html  # Страница управления кодами доступа
│   ├── client-guide.html  # Инструкция для клиентов
│   ├── users.html         # Управление пользователями
│   └── sessions.html      # Управление сессиями
```

## Установка и запуск

### Локальная установка
1. Клонируйте репозиторий
2. Установите зависимости: `npm install`
3. Запустите сервер: `npm start` или `npm run dev` для разработки
4. Сервер будет доступен по адресу http://localhost:3000

### Развертывание
Проект размещен на Render.com с доменом zxc11.space.

## Аутентификация и безопасность

- Защищенные маршруты API с проверкой аутентификации
- Хеширование паролей с использованием SHA-256 и уникальной соли
- Сессии с ограниченным временем жизни (24 часа по умолчанию)
- Проверка доступа на основе ролей (администратор/пользователь)

## Подключение к клиентам

### Через код доступа
1. Создайте код доступа в админ-панели
2. Посетите URL формата: `https://zxc11.space/guide/[код]`
3. Используйте букмарклет для подключения к клиенту

### Через букмарклет
```javascript
javascript:import('https://zxc11.space/[код]')
```

## Функциональность клиента

- Автоматическое подключение к серверу WebSocket
- Сбор данных страницы (URL, заголовок, текст)
- Отправка обновлений на сервер
- Отображение сообщений от администратора
- Поддержка горячих клавиш:
  - `Shift + M` - показать/скрыть историю сообщений
  - `↑/↓` - навигация по сообщениям
  - `+/-` - изменить размер текста
  - `Esc` - скрыть сообщение или историю

## Пользовательский интерфейс администратора

- Панель клиентов с отображением активных подключений
- Просмотр содержимого страниц клиентов
- Отправка сообщений с настраиваемой прозрачностью
- Управление кодами доступа для новых подключений
- Просмотр истории сообщений и взаимодействий
- Настройка параметров отображения и обновления

## Устойчивость соединений

- Автоматическое переподключение при потере соединения
- Пинг-понг для проверки активности соединений
- Сохранение неотправленных данных при отключении
- Восстановление состояния при переподключении клиентов

## Функции для будущей разработки

- Запись и воспроизведение сессий
- Расширенная аналитика действий пользователя
- Дополнительные способы интеграции
- API для внешних интеграций
- Поддержка групп клиентов 